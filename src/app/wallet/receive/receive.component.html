<app-header>
  <div fxLayout="row" fxlayout.lt-sm="column"> 
    <div fxFlex="1 1 70%">
      <md-tab-group (selectChange)="changeTab($event.index)">
        <md-tab>
          <ng-template md-tab-label>
            Public
          </ng-template>
        </md-tab>
        <md-tab>
          <ng-template md-tab-label>
            Private
          </ng-template>
        </md-tab>
      </md-tab-group>
    </div>
    <md-form-field class="icon-input search-address" fxFlex="0 1 400px" (click)="selectInput()"> 
      <input mdInput type="text" class="header-input" id="searchbar" [(ngModel)]="query" placeholder="Search receive addresses">
      <md-icon>search</md-icon>
    </md-form-field>
  </div>
</app-header>

<div class="container-block" fxLayout="row" fxLayoutGap="40px">

  <!-- QR code -->
  <div fxFlex="0 0 200px" *ngIf="selected">
    <md-card class="qr-card">
      <div #qrCode class="qrcode">
        <qr-code [size]="getQrSize()" [level]="H" value="particl:{{ selected.address }}">
        </qr-code>
      </div><!-- qrcode -->

      <div class="address-details">
        <div class="details-title">
          {{ getAddressType() }} address
        </div>
        <div class="details-label">
          {{ selected.label }}
        </div>
        <div class="details-address" fxLayoutWrap layout-padding fxLayoutAlign="center center">
          <div *ngFor="let word of selected.readable" class="address-word" fxFlex="33">
            {{ word }}
          </div>
        </div>
        <button md-raised-button color="primary" (click)="openNewAddress()">New {{ getAddressType() }} address</button>
      </div><!-- .address-details -->
    </md-card>
  </div>

  <!-- Address list -->
  <div fxFlex="1 1 calc(100% - 240px)" *ngIf="getUnusedAddress()">

    <md-list class="list-data" *ngIf="inSearchMode() === false">
      <div md-subheader class="address-title">Unused address</div>

      <md-card class="address-info">
        <div fxFlex="100%" fxLayout="row" fxLayout.lt-lg="column" fxLayoutGap="10px" layout-padding>
          <div fxFlex="15%" class="address-id"> /{{ getUnusedAddress().id }}</div>
          <div fxFlex="20%" class="address-label"> {{ getUnusedAddress().label }}</div>
          <div fxFlex="50%" class="address">
            {{ getUnusedAddress().address }}
            <!--div class="total"><span>Total received: </span>
              <span class="received-amount">{{ getUnusedAddress().balance }}</span>
            </div-->
          </div>
          <div fxFlex="15%" fxLayoutAlign="end center">
            <!-- Copy address -->
            <span fxFlex="20%" fxFlex.md="100%" fxFlex.sm="33.33%">
              <md-icon class="cursor-pointer" mdTooltip="Copy address" ngxClipboard [cbContent]="getUnusedAddress().address" fontSet="ncIcon" fontIcon="nc-copy-2"></md-icon>
            </span>
            <!-- Sign message (?) -->
            <div fxFlex="20%" fxFlex.md="100%" fxFlex.sm="33.33%">
              <md-icon fontSet="ncIcon" fontIcon="nc-a-check" mdTooltip="Sign (????) message" class="TODO"></md-icon>
            </div>
            <!-- Select address -->
            <span fxFlex="20%" fxFlex.md="100%" fxFlex.sm="33.33%">
              <md-icon class="material-icons cursor-pointer nc-icon nc-barcode-qr" mdTooltip="Select Address" (click)="selectAddress(addresses[getAddressType()][0])"></md-icon>
            </span>
          </div>
        </div>
      </md-card>
      <div class="widget-help">
        <span class="TODO">@FIXME:</span> It is advised to use new addresses for each Public transaction (or person) for greater privacy.
      </div>
    </md-list><!-- .list-data -->


    <md-list *ngIf="getSinglePage().length" class="list-data">
      <div md-subheader class="address-title">Previous addresses</div>
      <div *ngFor="let address of getSinglePage()">

        <md-card class="address-info"> 
          <div fxFlex="100%" fxLayout="row" fxLayout.lt-lg="column" fxLayoutGap="10px" layout-padding> 
            <div fxFlex="15%" class="address-id">/{{ address.id }}</div> 
            <div fxFlex="20%" class="address-label">{{ address.label }}</div>
            <div fxFlex="50%" class="address">
              {{ address.address }}
              <div class="total"><span>Total received: </span>
                <span class="received-amount TODO">{{ address.balance }}</span>
              </div>
            </div>
            <div fxFlex="15%" fxLayoutAlign="end center">
              <!-- Copy address -->
              <span fxFlex="20%" fxFlex.md="100%" fxFlex.sm="33.33%">
                <md-icon fontSet="ncIcon" fontIcon="nc-copy-2" class="cursor-pointer" mdTooltip="Copy address" ngxClipboard [cbContent]="address.address"></md-icon>
              </span>
              <!-- Sign message (?) -->
              <span fxFlex="20%" fxFlex.md="100%" fxFlex.sm="33.33%">
                <md-icon fontSet="ncIcon" fontIcon="nc-a-check" mdTooltip="Sign (????) message" class="cursor-pointer TODO" ngxClipboard></md-icon>
              </span>
              <!-- Select address -->
              <span fxFlex="20%" fxFlex.md="100%" fxFlex.sm="33.33%">
                <md-icon class="material-icons cursor-pointer nc-icon nc-barcode-qr" mdTooltip="Select Address" (click)="selectAddress(address)"></md-icon>
              </span>
            </div>
          </div>
        </md-card>

      </div>
    </md-list><!-- .list-data -->

    <pagination
      [boundaryLinks]="true"
      (pageChanged)="pageChanged($event)"
      [totalItems]="getTotalCountForPagination()"
      [maxSize]="5" [rotate]="false"
      [(ngModel)]="page"
      class="pagination-sm center"
      previousText="&lsaquo;" nextText="&rsaquo;"
      firstText="&laquo;" lastText="&raquo;"
      [itemsPerPage]="MAX_ADDRESSES_PER_PAGE">
    </pagination>
  </div>

  

</div>
