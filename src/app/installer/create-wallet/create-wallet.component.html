<div class="installer">

  <div class="sidebar">
    <img class="logo" src="./assets/particl-logo-vertical.svg">
    <div class="progress">
      <div class="step first" [ngClass]="{'active': step === Steps.START, 'done': step > Steps.START}">
        <div class="number">1</div>
        <div class="desc">Create/restore</div>
      </div>
      <div class="step" [ngClass]="{'active': step === Steps.WALLET_NAME, 'done': step > Steps.WALLET_NAME}">
        <div class="number">2</div>
        <div class="desc">Name wallet</div>
      </div>
      <div class="step" [ngClass]="{'active': step === Steps.ENCRYPT, 'done': step > Steps.ENCRYPT}">
        <div class="number">3</div>
        <div class="desc">Encrypt wallet</div>
      </div>
      <div class="step" [ngClass]="{'active': step === Steps.MNEMONIC_INITIAL, 'done': step > Steps.MNEMONIC_INITIAL}">
        <div class="number">4</div>
        <div class="desc">Recovery Phrase</div>
      </div>
      <div class="step" [ngClass]="{'active': step === Steps.PASSWORD, 'done': step > Steps.PASSWORD}">
        <div class="number">5</div>
        <div class="desc">Recovery Password</div>
      </div>
      <!-- 
      <div class="step" [ngClass]="{'active': step === Steps.SETTINGS, 'done': step > Steps.SETTINGS}">
        <div class="number">6</div>
        <div class="desc">Basic settings</div>
      </div> -->
      <div class="step last" [ngClass]="{'active': step === Steps.COMPLETED}">
        <div class="number">6</div>
        <div class="desc">Summary</div>
      </div>
    </div>
  </div>

  <div class="content">


    <!-- STEP 0: Choose action -->
    <ng-template [ngIf]="step === Steps.START">
      <div class="title">Create or restore wallet</div>
      <div class="container-block">
        <p>
          In order to connect to Particl network, you need to have a wallet. If you're using Particl for the first time, create a new
          wallet or restore existing wallet (using your Recovery Passphrase) if you have one already. You can create as many
          wallets as you need.
        </p>
        <div class="huge action-buttons">
          <mat-card class="create half">
            <mat-icon class="icon" fontSet="partIcon" fontIcon="part-add-account"></mat-icon>
            <div class="choice-title">Create wallet</div>
            <p class="choice-desc">
              You don't have a&nbsp;wallet yet and/or you want to create a&nbsp;new one
            </p>
            <button mat-raised-button color="primary" (click)="initialize(0);">
              <mat-icon fontSet="partIcon" fontIcon="part-add-account"></mat-icon>
              Create new wallet
            </button>
          </mat-card>
          <mat-card class="restore half">
            <mat-icon class="icon" fontSet="partIcon" fontIcon="part-refresh"></mat-icon>
            <div class="choice-title">Restore wallet</div>
            <p class="choice-desc">
              If you already have existing wallet seed (Recovery Phrase) that you would like to restore
            </p>
            <button mat-raised-button color="accent" (click)="initialize(1);">
              <mat-icon fontSet="partIcon" fontIcon="part-refresh"></mat-icon>
              Restore wallet
            </button>
          </mat-card>
        </div>
        <!-- .huge.action-buttons -->
      </div>
      <!-- .container-block -->
      <div class="action-buttons" fxLayoutAlign="space-between center">
        <button *ngIf="!isDefaultWallet" mat-button (click)="closeAndReturnToDefault()">
          <mat-icon fontSet="partIcon" fontIcon="part-previous-single"></mat-icon>
          Cancel
        </button>
      </div>
      <!-- .action-buttons -->
    </ng-template>
    <!-- step 0 -->


    <!-- STEP 1: Create/restore wallet -->
    <ng-template [ngIf]="step === Steps.WALLET_NAME">
      <form #nameForm="ngForm" (ngSubmit)="nextStep()">

        <div class="title">Name your wallet</div>
        <div class="container-block">
          <p>
            Naming your wallets is useful, when you want to use multiple wallets &ndash; this helps you to separate e.g. your personal
            and market funds.
            <br> Short and descriptive names work the best!
          </p>
          <mat-card class="wallet-name">
            <p class="warning" *ngIf="validation.errors && (validation.dirty || validation.touched)">
              Wallet name is required
            </p>
            <!-- validation errors -->
            <div class="box-title">Choose wallet name</div>
            <mat-form-field class="largest">
              <input matInput #nameField #validation="ngModel" [(ngModel)]="walletname" name="walletname" placeholder="Wallet name (required)" required
                maxlength="32" [class.verify-error]="validation.errors && (validation.dirty || validation.touched)" />
              <mat-hint class="error" *ngIf="!!errorString">
                {{ errorString }}
              </mat-hint>
            </mat-form-field>
            <p class="widget-help">
              Wallet name should contain only letters, numbers, spaces (
              <code> </code>), dashes (
              <code>-</code>) and underscores (
              <code>_</code>).
            </p>
          </mat-card>
        </div>
        <!-- .container-block -->

        <div class="action-buttons" fxLayoutAlign="space-between center">
          <button mat-button (click)="prevStep()">
            <mat-icon fontSet="partIcon" fontIcon="part-previous-single"></mat-icon>
            Back
          </button>
          <button mat-raised-button color="primary" type="submit" [disabled]="!nameForm.form.valid">
            <mat-icon fontSet="partIcon" fontIcon="part-next-single"></mat-icon>
            Continue
          </button>
        </div>
        <!-- .action-buttons -->
      </form>
    </ng-template>
    <!-- step 1 -->


    <!-- STEP 2: Encrypt wallet -->
    <ng-template [ngIf]="step === Steps.ENCRYPT">
      <div class="title">Encrypt your wallet</div>
      <div *ngIf="!isEncrypting" class="container-block">
        <p>
          It is recommended to encrypt your wallet before creating or restoring a wallet,
          <br> in order to not leave any possible key fragments lying around.
        </p>
        <p class="widget-help">
          Note that you can safely skip this step, but it is recommended to encrypt your wallet as 
          <br> protects you from unauthorized access to your coins (e.g. if someone steals your computer).
          <br> It affects Particl wallet only on your current device.
        </p>
        <mat-card class="action-card recovery-password">
          <div class="box-title">Choose Encryption Password</div>
          <!-- Password -->
          <mat-form-field class="password-input largest">
            <input #passwordElem matInput placeholder="Enter Encryption Password" [type]="passwordElem.show ? 'text' : 'password'" [(ngModel)]="encrypt">
            <mat-hint class="error" *ngIf="!validate()">
              {{ errorString }}
            </mat-hint>
          </mat-form-field>
          <!-- Password comfirmation -->
          <mat-form-field class="password-input largest">
            <input matInput placeholder="Confirm Encryption Password" [type]="passwordElem.show ? 'text' : 'password'" [(ngModel)]="encryptVerify">
          </mat-form-field>
          <button mat-button class="small show-password" (click)="passwordElem.show = !passwordElem.show">
            <mat-icon fontSet="partIcon" fontIcon="{{passwordElem.show ? 'part-anon' : 'part-public'}}"></mat-icon>
            {{ passwordElem.show ? 'Hide' : 'Show' }} password
          </button>
          <p class="warning bottom">
            Do NOT forget this password or you will be unable to access your coins!
          </p>
        </mat-card>
        <!-- .action-card -->
      </div>
      <!-- .container-block -->

      <div *ngIf="isEncrypting" class="container-block">
        <div class="center">
          <mat-spinner class="loading-spinner"></mat-spinner>
          <p class="lead">
            Encrypting your wallet
          </p>
        </div>
      </div>
      <!-- .container-block -->

      <div class="action-buttons" fxLayoutAlign="space-between center">
        <button mat-button (click)="prevStep()">
          <mat-icon fontSet="partIcon" fontIcon="part-previous-single"></mat-icon>
          Back
        </button>
        <button mat-raised-button color="primary" (click)="nextStep()" [disabled]="!validate()">
          <mat-icon fontSet="partIcon" fontIcon="part-next-single"></mat-icon>
          Continue
        </button>
      </div>
    </ng-template>
    <!-- step 2 -->


    <!-- STEP 2-3 (Create): Recovery Phrase -->
    <ng-template [ngIf]="[Steps.MNEMONIC_INITIAL,Steps.MNEMONIC_VERIFY,Steps.PASSWORD].indexOf(step) != -1 && isCreate">

      <div class="title" *ngIf="step === Steps.MNEMONIC_INITIAL">Recovery Phrase</div>
      <div class="title" *ngIf="step === Steps.MNEMONIC_VERIFY">Confirm Recovery Phrase</div>
      <div class="title" *ngIf="step === Steps.PASSWORD">Choose a Recovery Password
        <small>(optional)</small>
      </div>
      <div class="container-block">

        <div *ngIf="step === Steps.MNEMONIC_INITIAL">
          <div class="title">{{ walletname || 'Default Wallet' }}</div>
          <p>
            Recovery Phrase (sometimes also called "wallet seed") is a backup key to your coins. Anyone with access to these 24 words
            can recover your wallet, so make sure they are safe and ideally backed-up on multiple locations.
          </p>
          <p class="widget-help">
            You can further increase security of your Recovery Phrase in the next step.
          </p>
        </div>

        <div *ngIf="step === Steps.MNEMONIC_VERIFY">
          <p>
            Confirm that you backed up your Recovery Phrase by filling in the missing words:
          </p>
          <p class="widget-help">
            If you're not absolutely sure, that you have all Recovery Passphrase words correctly saved, you can always go one step back
            double check.
          </p>
        </div>

        <!-- Passphrase (step 2-3) -->
        <ng-template [ngIf]="[Steps.MNEMONIC_INITIAL,Steps.MNEMONIC_VERIFY].indexOf(step) != -1">
          <mat-card class="action-card">
            <app-passphrase #passphraseComponent [readOnly]="step === Steps.MNEMONIC_INITIAL" [words]="words" [partialDisable]="step === Steps.MNEMONIC_VERIFY"
              [generate]="true">
            </app-passphrase>
            <p class="warning bottom" *ngIf="step === Steps.MNEMONIC_INITIAL">
              It's only up to you to keep these words safe! If you lose them (or someone steals them),
              <br> nody can help you recover your funds! You have been warned.
            </p>
          </mat-card>
        </ng-template>

        <!-- Recovery Password (step 4) -->
        <div *ngIf="step === Steps.PASSWORD">
          <p>
            You can further increase your wallet protection by setting a Recovery Password.
            <br> It will be needed together with Recovery Phrase to access your coins.
          </p>
          <p class="widget-help">
            Note that you can safely skip this step, but it is recommended to choose a Recovery Password as it keeps your coins safer.
          </p>
          <mat-card class="action-card recovery-password">
            <div class="box-title">Choose Recovery Password</div>
            <!-- Password -->
            <mat-form-field class="password-input largest">
              <input #passwordElem matInput placeholder="Enter Recovery Password" [type]="passwordElem.show ? 'text' : 'password'" [(ngModel)]="password">
              <mat-hint class="error" *ngIf="!!errorString">
                {{ errorString }}
              </mat-hint>
            </mat-form-field>
            <!-- Password comfirmation -->
            <mat-form-field class="password-input largest">
              <input matInput placeholder="Confirm Recovery Password" [type]="passwordElem.show ? 'text' : 'password'" [(ngModel)]="passwordVerify">
            </mat-form-field>
            <button mat-button class="small show-password" (click)="passwordElem.show = !passwordElem.show">
              <mat-icon fontSet="partIcon" fontIcon="{{passwordElem.show ? 'part-anon' : 'part-public'}}"></mat-icon>
              {{ passwordElem.show ? 'Hide' : 'Show' }} password
            </button>
            <p class="warning bottom">
              If you set a Recovery Password, be sure to keep it safe along with your Recovery Phrase.
              <br> If you forget any of these, you won't be able to access your coins!
            </p>
          </mat-card>
          <!-- .action-card -->
        </div>

      </div>
      <!-- .container-block -->

      <div class="action-buttons" fxLayoutAlign="space-between center">
        <button mat-button (click)="prevStep()">
          <mat-icon fontSet="partIcon" fontIcon="part-previous-single"></mat-icon>
          Back
        </button>
        <button mat-raised-button color="primary" (click)="nextStep()" [disabled]="!validate()">
          <!-- TODO: Move sendPassword to .ts   -->
          <mat-icon fontSet="partIcon" fontIcon="part-next-single"></mat-icon>
          Continue
        </button>
      </div>

    </ng-template>
    <!-- Step 2,3 & 4 -->


    <!-- STEP 2-4 (Restore) -->
    <ng-template [ngIf]="step === Steps.MNEMONIC_INITIAL && isRestore">
      <div class="title">Restore existing wallet</div>
      <div class="container-block">

        <p>
          For restoring your existing wallet, you will need its Recovery Phrase (and also Recovery Password if you have set it up):
        </p>
        <p class="widget-help">
          <strong>Friendly reminder:</strong> Don't forget that the Recovery Phrase (and Password) are very important for keeping
          your funds safe. Anyone with access to them has access to your coins. If you think your Recovery Phrase (and Password)
          might have been exposed, it would be better to create a new wallet instead and send your coins there.
        </p>

        <mat-card class="action-card">
          <div class="recovery-phrase">
            <app-passphrase #passphraseComponent [words]="words" [generate]="false">
            </app-passphrase>
            <p *ngIf="!!errorString" class="warning bottom">
              {{ errorString }}
            </p>
          </div>
          <!-- .recovery-phrase -->
        </mat-card>

        <mat-card class="action-card recovery-password">
          <div class="box-title">Recovery Password</div>
          <p>
            If you set up a Recovery Password during wallet creation as well, enter it below:
          </p>
          <p class="widget-help">
            If you created your wallet in Particl Desktop v1.1, a bug prevented Recovery Password to be set. If that's your case, don't
            enter any password even if you set one up.
          </p>
          <mat-form-field class="password-input larger">
            <input #passwordRestoreElem matInput placeholder="Enter your password" [type]="passwordRestoreElem.show ? 'text' : 'password'"
              [(ngModel)]="password">
          </mat-form-field>
          <button mat-button class="small show-password" (click)="passwordRestoreElem.show = !passwordRestoreElem.show">
            <mat-icon fontSet="partIcon" fontIcon="{{passwordRestoreElem.show ? 'part-anon' : 'part-public'}}"></mat-icon>
            {{ passwordRestoreElem.show ? 'Hide' : 'Show' }} password
          </button>
        </mat-card>
        <!-- .recovery-password -->

      </div>
      <div class="action-buttons" fxLayoutAlign="space-between center">
        <button mat-button (click)="prevStep()">
          <mat-icon fontSet="partIcon" fontIcon="part-previous-single"></mat-icon>
          Back
        </button>
        <button mat-raised-button color="primary" (click)="nextStep()" [disabled]="!validate()">
          <mat-icon fontSet="partIcon" fontIcon="part-next-single"></mat-icon>
          Continue
        </button>
      </div>

    </ng-template>
    <!-- Step 2,3 & 4 -->


    <!-- STEP 5: Waiting for import -->
    <ng-template [ngIf]="step === Steps.WAITING">
      <div class="title">Your wallet is nearly ready</div>
      <div class="container-block preparing-wallet">
        <div class="center">
          <mat-spinner class="loading-spinner"></mat-spinner>
          <p class="lead">
            Preparing your wallet
          </p>
          <p class="widget-help">
            Creating your wallet &amp; scanning for transactions
          </p>
        </div>
      </div>
    </ng-template>

    <!-- STEP 6: Gratz -->
    <ng-template [ngIf]="step === Steps.COMPLETED">
      <div class="title">Your wallet is ready</div>
      <div class="container-block">
        <p>
          Congratulations &ndash; your new wallet was created successfully!
        </p>
        <p class="info">
          Please ensure that your Recovery Phrase (and Recovery Password if you've set it up) is written down and stored in a secure
          location!
        </p>
        <p>
          You can now safely close this wizard and start experiencing Particl!
        </p>
      </div>
      <div class="action-buttons" fxLayoutAlign="end center">
        <button mat-raised-button color="primary" (click)="close()">
          <mat-icon fontSet="partIcon" fontIcon="part-check"></mat-icon>
          Finish setup & Close
        </button>
      </div>
    </ng-template>


    <!-- STEP 6 -->
    <!--ng-template [ngIf]="step === 6">
  <app-unlockwallet (unlockEmitter)="importMnemonicSeed($event)" [autoClose]="false">
  </app-unlockwallet>
</ng-template-->


  </div>
  <!-- .content -->
</div>
<!-- .installer -->
